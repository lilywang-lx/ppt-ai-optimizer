# 多模型协同的PPT智能优化与自动生成网页系统

## 核心指令

请基于 Python 全栈技术栈,开发一个**网页端 PPT 智能优化生成系统**,实现「上传PPT→多PPT专用大模型并行分析→跨模型迭代修正→输出最终优化方案→自动生成新PPT」的端到端流程。要求代码结构清晰、模块化强,具备可扩展性,支持后续对接更多PPT大模型接口;重点强化多模型迭代修正的有效性,通过标准化、差异化、结构化设计,确保模型结果高效协同、冲突可控。

## 一、项目背景与目标

1.  **背景**:用户需要一个轻量化网页工具,无需本地安装软件,上传PPT文件后,即可借助多个PPT专用大模型的能力,获取多维度优化建议;通过模型间的交叉修正,解决单一模型建议片面的问题;最终基于最优方案自动生成符合要求的新PPT。

2.  **核心目标**

- 前端支持PPT文件(pptx格式)上传、进度展示、结果预览与下载

- 后端实现PPT解析、多模型接口调用、跨模型建议迭代修正(确保修正有效性)、PPT自动生成

- 系统具备高扩展性,可灵活新增/删减PPT专用大模型

## 二、核心功能与技术流程

### (一)功能模块拆解

1.  **前端模块**

- 页面布局:上传区域(支持拖拽+点击上传)、进度条(显示"解析中/模型分析中/迭代修正中/生成中")、多模型建议展示区(分Tab页展示讯飞星火、文心一言、通义千问、腾讯混元的标准化原始建议)、最终建议展示区(标注修正轨迹与冲突调和结果)、新PPT下载按钮

- 交互逻辑:上传后校验文件格式(仅支持pptx);实时反馈各阶段进度;支持用户选择是否开启"跨模型迭代修正"功能;当模型建议冲突率超过10%时,弹窗提示用户手动选择冲突建议优先级

2.  **后端核心模块**

**模块1:PPT解析器**

- 功能:接收前端上传的pptx文件,解析提取PPT的核心信息,包括:每页幻灯片的版式(标题页/内容页/图表页等)、文本内容、图片/图表位置、配色方案、字体样式、内容逻辑结构

- 技术要求:使用 `python-pptx` 库实现解析,将解析结果封装为标准化JSON格式(字段包括 slide_id、slide_type、content、layout_info、style_info),为后续模型输入标准化奠定基础

**模块2:多PPT大模型调用引擎**

- 支持对接以下4个主流PPT专用大模型(预留扩展接口):
        ① 讯飞星火PPT智能助手(API文档:https://www.xfyun.cn/doc/spark/ppt-assistant.html)
        ② 百度文心一言PPT优化模块(API文档:https://yiyan.baidu.com/developer/docs/ppt-optimize)
        ③ 阿里云通义千问PPT生成器(API文档:https://help.aliyun.com/document_detail/2511236.html)
        ④ 腾讯混元PPT智能分析模型(API文档:https://cloud.tencent.com/document/product/1729/95224)

- 核心逻辑:
        1.  将标准化PPT解析数据,按各模型API要求封装为对应的提示词(例如讯飞星火需补充"PPT行业场景"参数,文心一言需指定"优化粒度"为"逐页精细化")
        2.  并行调用上述4个模型接口,指定优化方向(内容逻辑优化、排版设计优化、配色字体优化、图表可视化优化)
        3.  接收各模型返回的优化建议,统一解析转换为标准化JSON格式(确保模型间"语言互通"),按模型分类存储。标准化JSON格式示例:
            ```json
{
  "ppt_id": "upload_123456",
  "model_name": "讯飞星火PPT智能助手",
  "optimization_suggestions": [
    {
      "slide_index": 1,  // 幻灯片页码
      "optimization_dimension": "layout",  // 优化维度:content/logic/layout/color/font/chart
      "original_content": "标题为"项目总结",字体18号,居中",  // 原始内容
      "suggestion": "将标题字体改为24号微软雅黑,左对齐,添加蓝色渐变效果",  // 具体建议
      "reason": "标题字号过小,居中排版不符合商务PPT阅读习惯",  // 建议理由
      "priority": "recommend"  // 优先级:must/recommend/optional
    }
  ],
  "core_strength": "scene_adaptation"  // 模型核心优势标识
}
```
        4.  为每个模型配置独立的API Key、请求头、请求参数模板,加入超时重试机制与异常降级策略(调用失败则跳过,使用剩余模型完成分析)

- 技术要求:使用 `requests` 库调用API;使用多线程/异步(`asyncio`)实现并行调用,提升效率;确保输出格式标准化,为后续迭代修正提供统一输入

**模块3:跨模型建议迭代修正器(核心强化模块)**

- 核心目标:通过标准化、差异化、结构化设计,确保不同模型结果高效迭代修正,避免建议冲突,形成闭环优化逻辑

- 核心逻辑(分阶段执行):
        1.  **输入标准化封装**:将前序模型的标准化建议,按固定格式封装为下一轮修正模型的输入,示例:
            ```
【修正任务】
1. 原始PPT信息:{标准化PPT解析数据}
2. 待修正建议(来自{模型名称}):{标准化JSON建议内容}
3. 修正侧重点:{对应模型核心优势维度,如文心一言侧重layout/color}
4. 修正规则:保留合理部分(标注"保留:xxx")、修正不合理部分(说明"原建议xxx→新建议xxx,理由:xxx")、补充遗漏点(标注"补充:xxx")
5. 输出要求:严格遵循指定标准化JSON格式,不得增减字段
```
        2.  **差异化分工迭代**:基于各模型核心优势分配修正角色,按固定流程串行迭代(默认2轮,支持配置调整):
            - 第一轮:讯飞星火输出全维度原始建议(侧重场景化适配),传给文心一言,仅修正"排版(layout)""配色(color)"维度
            - 第二轮:文心一言修正后的结果,传给通义千问,仅修正"内容逻辑(logic)""图表可视化(chart)"维度
            - 最终融合:将通义千问修正结果传给腾讯混元,依托其多建议融合能力,汇总所有结果并调和冲突,生成统一最终方案
        3.  **迭代终止条件**:满足以下任一条件即停止迭代:① 达到预设最大轮次(默认2轮,可配置);② 建议冲突率低于5%(冲突率=冲突建议条数/总建议条数)

- 冲突检测与调和机制:
        1.  冲突检测:逐页、逐维度对比模型建议,识别矛盾点(如A建议标题红色,B建议蓝色)
        2.  调和规则(按优先级执行):
            - 规则优先:预设行业规范优先级(如商务PPT配色:品牌色＞模型建议色;排版:行业通用规范＞模型建议)
            - 模型仲裁:无预设规则时,由腾讯混元基于行业最佳实践仲裁,输出最优建议及理由
            - 人工兜底:冲突率超过10%时,将冲突点反馈至前端,提示用户手动选择优先级
        3.  调和结果需标注"调和依据"(规则/模型仲裁/人工选择),关联原始建议,确保可追溯

- 最终方案生成:腾讯混元融合所有修正结果,标注建议优先级(must/recommend/optional),附带修正轨迹(各模型贡献点、调和记录),形成最终优化方案

- 技术要求:支持迭代轮次、参与模型列表可配置;冲突检测逻辑需精准匹配标准化字段;修正轨迹全程记录,关联至最终方案

**模块4:PPT自动生成器**

- 功能:基于最终优化方案,优先调用「阿里云通义千问PPT生成器」API,若调用失败则降级使用 `python-pptx` 库,自动修改原始PPT或生成全新PPT

- 生成逻辑:
        1.  内容层面:按照优化建议调整文本逻辑、补充缺失内容、精简冗余信息(参考通义千问的内容优化逻辑)
        2.  排版层面:调整字体大小/颜色、幻灯片版式、图片/图表位置(参考文心一言的排版建议)
        3.  样式层面:统一配色方案、添加符合主题的设计元素(参考讯飞星火的场景化设计建议)

- 输出:生成新的pptx文件,支持前端下载,文件附带优化日志(简要说明各模型贡献与冲突调和情况)

### (二)技术栈要求

- 前端:优先使用 **Vue3 + Element Plus** 或 **React + Ant Design**,实现简洁美观的交互界面,支持冲突点手动选择、修正轨迹预览

- 后端:**Python + FastAPI/Flask** 搭建接口服务;使用 `python-pptx` 处理PPT解析与生成;使用 `asyncio` 实现多模型并行调用;新增冲突检测、格式标准化工具类

- 模型对接:为4个模型分别配置独立的接口调用函数与标准化转换函数,预留 API Key、请求头配置项;支持自定义各模型的请求参数与修正侧重点

- 部署:代码需支持容器化部署(提供 Dockerfile),便于后续云端部署

## 三、输出要求

- 生成完整的**项目代码**,包括前端页面、后端接口、各功能模块代码、配置文件(含4个模型的接口配置模板、标准化格式模板、冲突调和规则配置)

- 提供**详细的 README.md**,包含:项目介绍、环境搭建步骤、4个模型的API Key申请与配置方法、启动命令、功能测试用例(重点覆盖迭代修正与冲突调和场景)

- 代码需附带**注释**,关键模块(模型调用、标准化转换、迭代修正逻辑、冲突调和)需写明设计思路与执行流程

- 预留**扩展接口文档**,指导如何新增PPT专用大模型(如SlideAI、Canva AI PPT),并说明新增模型的标准化适配方法与修正角色分配规则

## 四、额外约束

- 考虑到PPT文件可能较大,需实现**分片上传**或**断点续传**功能,避免上传超时

- 迭代修正逻辑需支持**可配置化**,允许用户在后台设置迭代轮次、参与修正的模型列表、冲突率阈值(默认5%终止、10%人工兜底)

- 加入**精细化日志模块**,记录每一步操作:文件上传信息、4个模型的调用结果(成功/失败)、每轮修正的具体内容(保留/修正/补充点)、冲突检测与调和记录、PPT生成过程,日志需关联ppt_id,便于问题排查与修正轨迹追溯

- 为每个模型的接口调用添加**异常降级策略**:若某模型调用失败(如API Key过期、接口超时),自动跳过该模型,使用剩余模型完成分析,并在日志与前端结果中标注"该模型调用失败,已降级处理"

- 标准化格式需支持**扩展性**,新增优化维度时可灵活新增字段,不影响现有迭代修正逻辑

## 五、启动指令

请基于以上需求,生成可直接运行的项目代码框架,并给出测试方案,确保系统能完成从PPT上传到新PPT生成的全流程闭环;重点保证4个模型的接口调用、标准化转换、迭代修正(含冲突调和)逻辑可落地,确保多模型修正结果有效、可控。

> (注:文档部分内容可能由 AI 生成)
